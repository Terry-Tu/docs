# 5 后台接口对接

## 5.1 基础接口

### 5.1.1 获取backendToken<backendToken>

#### 5.1.1.1功能描述

基础服务令牌，通过appId、secret换取，有效期为7200秒，后台接口调用凭证。

#### 5.1.1.2请求地址

https://open.95516.com/open/access/1.0/backendToken

#### 5.1.1.3报文结构

请求报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**                                                     |
| -------- | ---------- | ------------ | ------------------------------------------------------------ |
| 1.       | appId      | 是           | 接入方的唯一标识                                             |
| 2.       | nonceStr   | 是           | 生成签名的随机串                                             |
| 3.       | timestamp  | 是           | 生成签名的时间戳                                             |
| 4.       | signature  | 是           | 签名值，签名方法参见2.4.1报文签名  签名因子：appId、secret、nonceStr、timestamp |

 

响应报文参数说明

| **序号** | **参数名**   | **是否必填** | **备注**                                     |
| -------- | ------------ | ------------ | -------------------------------------------- |
| 1.       | backendToken |              | 后台接口调用凭证                             |
| 2.       | expiresIn    |              | backendToken接口调用凭证超时时间，单位（秒） |

 

注意：

Ø secret由云闪付分配给接入方的密钥，请求时无需上送，但需要作为签名因子进行签名。

Ø nonceStr生成规则参见附录三-生成签名随机字符串nonceStr。

Ø timestamp生成签名时间戳：接入方生成从1970年1月1日00:00:00至今的秒数，即当前的时间，单位为秒。

#### 5.1.1.4报文示例



### 5.1.2 获取frontToken<frontToken>

#### 5.1.2.1功能描述

基础服务令牌，通过appId、secret换取，有效期为7200秒，upsdk初始化凭证。

#### 5.1.2.2请求地址

[https://open.95516.com/open/access/1.0/](https://open.95516.com/open/access/1.0/backendToken)frontToken

#### 5.1.2.3报文结构

请求报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**                                                     |
| -------- | ---------- | ------------ | ------------------------------------------------------------ |
| 1.       | appId      | 是           | 接入方的唯一标识                                             |
| 2.       | nonceStr   | 是           | 生成签名的随机串                                             |
| 3.       | timestamp  | 是           | 生成签名的时间戳                                             |
| 4.       | signature  | 是           | 签名值，签名方法参见2.4.1报文签名  签名因子：appId、  secret、nonceStr、timestamp |

 

响应报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**                                   |
| -------- | ---------- | ------------ | ------------------------------------------ |
| 1.       | frontToken |              | UPSDK初始化凭证                            |
| 2.       | expiresIn  |              | frontToken接口调用凭证超时时间，单位（秒） |

 

​    注意：

Ø secret由云闪付分配给接入方的密钥，请求时无需上送，但需要作为签名因子进行签名。

Ø nonceStr生成规则参见附录三-生成签名随机字符串nonceStr。

Ø timestamp生成签名时间戳：接入方生成从1970年1月1日00:00:00至今的秒数，即当前的时间，单位为秒。

#### 5.1.2.4报文示例



 

## 5.2 获取用户信息

### 5.2.1 获取用户敏感信息-登陆手机号<user.mobile>

#### 5.2.1.1功能描述

用户联登且点击”确认授权”后，通过该接口可获取用户手机号码。

#### 5.2.1.2请求地址

https://open.95516.com/open/access/1.0/user.mobile

#### 5.2.1.3报文结构

请求报文参数说明

| **序号** | **参数名**   | **是否必填** | **备注**                                     |
| -------- | ------------ | ------------ | -------------------------------------------- |
| 1.       | appId        | 是           | 接入方的唯一标识                             |
| 2.       | accessToken  | 是           | 全局唯一接口调用凭证，通过用户联登获取       |
| 3.       | openId       | 是           | 第三方用户唯一凭证，通过用户联登获取         |
| 4.       | backendToken | 是           | 基础服务令牌，通过”获取backendToken”接口获取 |

 

响应报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**   |
| -------- | ---------- | ------------ | ---------- |
| 1.       | mobile     |              | 登录手机号 |

 

​    注意：

Ø 授权scope为upapi_mobile、upapi_auth、upapi_user的接入方才可以访问此接口。

Ø 此接口所有字段加密返回，请用云闪付分配给接入方的对称秘钥（symmetricKey）解密，加密内容为base64格式输出，参见安全规范2.4.2 对称密钥解密。

#### 5.2.1.4报文示例



### 5.2.2 获取用户信息-获取用户敏感信息-姓名+证件号码<user.auth>

#### 5.2.2.1功能描述

用户联登且点击”确认授权”后，后台通过该接口可获取用户证件信息。

#### 5.2.2.2请求地址

https://open.95516.com/open/access/1.0/user.auth

#### 5.2.2.3报文结构

请求报文参数说明

| **序号** | **参数名**   | **是否必填** | **备注**                                     |
| -------- | ------------ | ------------ | -------------------------------------------- |
| 1.       | appId        | 是           | 接入方的唯一标识                             |
| 2.       | accessToken  | 是           | 全局唯一接口调用凭证，通过用户联登获取       |
| 3.       | openId       | 是           | 第三方用户唯一凭证，通过用户联登获取         |
| 4.       | backendToken | 是           | 基础服务令牌，通过”获取backendToken”接口获取 |

 

响应报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**                                             |
| -------- | ---------- | ------------ | ---------------------------------------------------- |
| 1.       | realName   |              | 用户姓名                                             |
| 2.       | certTp     |              | 证件类型（01:身份证，03:护照，04:回乡证，05:台胞证） |
| 3.       | certId     |              | 证件号                                               |

 

​    注意：

Ø 授权scope为upapi_auth、upapi_user的特定接入方才能访问此接口。

Ø 此接口所有字段加密返回，请用云闪付分配给接入方的对称秘钥（symmetricKey）解密，加密内容为base64格式输出，参见安全规范2.4.2 对称密钥解密。

 

#### 5.2.2.4报文示例



### 5.2.3 用户授权解除通知接口

#### 5.2.3.1功能描述

调用第三方回调地址，通知信息授权解除结果。云闪付APP-安全中心-账号授权入口下进行解除信息授权使用。

#### 5.2.3.2请求地址

第三方回调地址。

#### 5.2.3.3报文结构

请求报文参数说明

| **序号** | **参数名** | **备注**                                    |
| -------- | ---------- | ------------------------------------------- |
| 1        | appId      | 接入方的唯一标识                            |
| 2        | timestamp  | 生成签名的时间戳                            |
| 3        | nonceStr   | 生成签名的随机串                            |
| 4        | openId     | OAUTH2中获取的openId                        |
| 5        | signature  | 请使用银联的公钥验证签名，输出格式为base64. |

 

响应报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**                                  |
| -------- | ---------- | ------------ | ----------------------------------------- |
| 1.       | resp       |              | 成功接收通知以后发送  {"resp": "00"} 返回 |

 

​    注意：

Ø 通知地址是入网申请时提交的后台对接通知域名。

Ø 示例代码可参考5.4.3通知解约结果接口。

 

## 5.3 支付密码验证

### 5.3.1 支付密码验证-获取支付密码验证流水号<verifyPwdSeqId>

#### 5.3.1.1功能描述

云闪付支付密码验证，通过”支付交易信息”换取”支付密码验证流水号”，供 upsdk（支付密码授权）接口使用。

#### 5.3.1.2请求地址

https://open.95516.com/open/access/1.0/verifyPwdSeqId

#### 5.3.1.3报文结构

请求报文参数说明

| **序号** | **参数名**  | **是否必填** | **备注**                                             |
| -------- | ----------- | ------------ | ---------------------------------------------------- |
| 1.       | appId       | 是           | 接入方的唯一标识                                     |
| 2.       | openId      | 是           | 第三方用户唯一凭证，通过用户联登获取                 |
| 3.       | clientIp    | 否           | 终端IP                                               |
| 4.       | bizOrderId  | 是           | 业务操作流水号                                       |
| 5.       | bizType     | 是           | 业务类型 （购买基金:4a）                             |
| 6.       | merchantId  | 是           | 商户号                                               |
| 7.       | nonceStr    | 是           | 生成签名的随机串                                     |
| 8.       | notifyUrl   | 是           | 通知地址                                             |
| 9.       | timestamp   | 是           | 生成签名的时间戳                                     |
| 10.      | accessToken | 是           | 基础服务令牌，通过”获取backendToken”接口获取         |
| 11.      | signature   | 是           | 签名值，签名方法参见2.4.1报文签名  签名因子:1-10字段 |

 

响应报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**             |
| -------- | ---------- | ------------ | -------------------- |
| 1.       | transNo    |              | 订单号，业务唯一标识 |

 

​    注意：

Ø clientIp，终端IP服务端IP地址。

Ø bizOrderId，业务操作流水号，由接入方生成需保证唯一，用于标识一笔唯一的支付密码验证交易。

Ø bizType，业务类型，请与云闪付业务方确定。

Ø notifyUrl，通知地址，请填写用于接收支付密码验证结果的服务地址。

#### 5.3.1.4报文示例



### 5.3.2 通知支付密码验证结果

#### 5.3.2.1功能描述

云闪付支付密码验证，根据”获取支付密码验证流水号”接口设置的通知地址（notifyUrl），云闪付将用户密码验证的结果通知接入方。

#### 5.3.2.2报文结构

通知报文参数说明

| **序号** | **参数名** | **备注**                                               |
| -------- | ---------- | ------------------------------------------------------ |
| 1.       | appId      | 接入方的唯一标识                                       |
| 2.       | timestamp  | 生成签名的时间戳                                       |
| 3.       | nonceStr   | 生成签名的随机串                                       |
| 4.       | openId     | OAUTH2中获取的openId                                   |
| 5.       | bizOrderId | 业务操作流水号                                         |
| 6.       | merchantId | 商户号                                                 |
| 7.       | bizType    | 业务类型                                               |
| 8.       | transNo    | 订单号，业务唯一标识                                   |
| 9.       | signature  | 输出格式为base64，请使用银联的公钥验证签名，参见附录五 |

 

返回报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**                                  |
| -------- | ---------- | ------------ | ----------------------------------------- |
| 1.       | resp       | 是           | 成功接收通知以后发送  {"resp": "00"} 返回 |

 

​    注意：

Ø 云闪付侧返回订单验证结果，使用云闪付私钥进行签名，接入方需要使用云闪付发布的公钥upPublicKey对收到的通知消息进行验证签名。

#### 5.3.2.3报文示例



 

## 5.4 无感支付

### 5.4.1 申请签约<contract.apply>

#### 5.4.1.1功能描述

无感支付签约接口，用户联登(SCOPE:upapi_contract)且点击”同意授权”后，后台可通过此接口发起支付签约。业务流程参考附录九：用户无感支付签解约流程。

#### 5.4.1.2请求地址

https://open.95516.com/open/access/1.0/contract.apply

#### 5.4.1.3报文结构

请求报文参数说明

| **序号** | **参数名**   | **是否必填** | **备注**                                     |
| -------- | ------------ | ------------ | -------------------------------------------- |
| 1.       | appId        | 是           | 接入方的唯一标识                             |
| 2.       | accessToken  | 是           | 全局唯一接口调用凭证，通过用户联登获取       |
| 3.       | openId       | 是           | 第三方用户唯一凭证，通过用户联登获取         |
| 4.       | backendToken | 是           | 基础服务令牌，通过”获取backendToken”接口获取 |
| 5.       | planId       | 是           | 协议模板id，由云闪付录入模板并分配给接入方   |
| 6.       | contractCode | 是           | 接入方侧的签约协议号，由接入方自行生成       |

 

响应报文参数说明

| **序号** | **参数名**   | **是否必填** | **备注**                                               |
| -------- | ------------ | ------------ | ------------------------------------------------------ |
| 1.       | contractCode |              | 接入方传来的签约协议号                                 |
| 2.       | planId       |              | 接入方传来的协议模板id                                 |
| 3.       | openId       |              | 凭此获取云闪付APP中接入方的appid下用户的唯一标识openid |
| 4.       | operateTime  |              | 操作时间                                               |
| 5.       | contractId   |              | 签约成功后，云闪付返回的委托免密支付协议 id。          |

 

​    注意：

Ø 只有授权scope为upapi_contract的特定接入方才能访问此接口。

#### 5.4.1.4报文示例



### 5.4.2 申请解约<contract.relieve>

#### 5.4.2.1功能描述

无感支付解约，使用接入方签约时传入的”签约协议号”，通过此接口可发起无感支付解约。

#### 5.4.2.2请求地址

https://open.95516.com/open/access/1.0/contract.relieve

#### 5.4.2.3报文结构

请求报文参数说明

| **序号** | **参数名**   | **是否必填** | **备注**                                               |
| -------- | ------------ | ------------ | ------------------------------------------------------ |
| 1.       | appId        | 是           | 接入方的唯一标识                                       |
| 2.       | openId       | 是           | 第三方用户唯一凭证，通过用户联登获取                   |
| 3.       | backendToken | 是           | 基础服务令牌，通过”获取backendToken”接口获取           |
| 4.       | contractId   | 是           | 委托免密支付签约成功后由云闪付返回的委托免密支付协议id |
| 5.       | planId       | 是           | 协议模板id，由云闪付录入模板并分配给接入方             |
| 6.       | contractCode | 是           | 接入方请求签约时传入的签约协议号，由接入方生产且须唯一 |

 

响应报文参数说明

| **序号** | **参数名**   | **是否必填** | **备注**                                               |
| -------- | ------------ | ------------ | ------------------------------------------------------ |
| 1.       | contractCode |              | 接入方传来的签约协议号                                 |
| 2.       | planId       |              | 接入方传来的协议模板id                                 |
| 3.       | openId       |              | 凭此获取云闪付APP中接入方的appId下用户的唯一标识openId |
| 4.       | operateTime  |              | 操作时间                                               |

 

​    注意：

Ø 只有授权scope为upapi_contract的特定接入方才能访问此接口。

#### 5.4.2.4报文示例



 

### 5.4.3 通知解约结果

#### 5.4.3.1功能描述

调用第三方回调地址，通知解约结果。云闪付APP-设置-支付设置-无感支付入口下进行无感支付解约使用，公交地铁脱机场景不支持云闪付侧解约。

#### 5.4.3.2请求地址

第三方回调地址。入网时申请表填写的解约结果通知地址。

#### 5.4.3.3报文结构

请求报文参数说明

| **序号** | **参数名**  | **是否必填** | **备注**                                                     |
| -------- | ----------- | ------------ | ------------------------------------------------------------ |
| 1.       | appId       | 是           | 接入方的唯一标识                                             |
| 2.       | timestamp   | 是           | 生成签名的时间戳                                             |
| 3.       | nonceStr    | 是           | 生成签名的随机串                                             |
| 4.       | operateTime | 是           | 操作时间                                                     |
| 5.       | openId      | 是           | 第三方用户唯一凭证，通过用户联登获取                         |
| 6.       | trid        | 是           | 特定场景使用                                                 |
| 7.       | contractId  | 是           | 签约成功后，云闪付返回的签约协议号，接入方凭此发起扣款，返回数据格式为AN32 |
| 8.       | signature   | 是           | 输出格式为base64，请使用银联的公钥验证签名，参见附录五       |

 

响应报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**                                  |
| -------- | ---------- | ------------ | ----------------------------------------- |
| 1.       | resp       |              | 成功接收通知以后发送  {"resp": "00"} 返回 |

 

​    注意：

Ø 只有授权scope为upapi_contract的特定接入方才能访问此接口。

#### 5.4.3.4报文示例-成功



#### 5.4.3.5报文示例-失败（验签不通过）



#### 5.4.3.6报文示例-异常



 

### 5.4.4 用户状态查询<contract.status>

#### 5.4.4.1功能描述

查询用户在云闪付侧是否存在无感支付业务未完成订单。

#### 5.4.4.2请求地址

https://open.95516.com/open/access/1.0/contract.status

#### 5.4.4.3报文结构

请求报文参数说明

| **序号** | **参数名**   | **是否必填** | **备注**                                     |
| -------- | ------------ | ------------ | -------------------------------------------- |
| 1.       | appId        | 是           | 接入方的唯一标识                             |
| 2.       | openId       | 是           | 第三方用户唯一凭证，通过用户联登获取         |
| 3.       | backendToken | 是           | 基础服务令牌，通过”获取backendToken”接口获取 |

 

响应报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**                                                  |
| -------- | ---------- | ------------ | --------------------------------------------------------- |
| 1.       | enable     |              | 返回0，表示无未完成订单；返回1-N，表示存在N笔未完成订单。 |

 

注意：

Ø 只有授权scope为upapi_contract的特定接入方才能访问此接口。

#### 5.4.4.4报文示例



### 5.4.5 签约关系查询<contract.info>

#### 5.4.5.1 功能描述

查询接入方用户在云闪付的签约关系。

#### 5.4.5.2 请求地址

[https://open.95516.com/open/access/1.0/contract. info ](https://open.95516.com/open/access/1.0/contract.status)

#### 5.4.5.3 报文结构

请求报文参数说明

| **序号** | **参数名**   | **是否必填** | **备注**                                     |
| -------- | ------------ | ------------ | -------------------------------------------- |
| 1        | appId        | 是           | 接入方的唯一标识                             |
| 2        | openId       | 是           | 第三方用户唯一凭证，通过用户联登获取         |
| 3        | backendToken | 是           | 基础服务令牌，通过”获取backendToken”接口获取 |
| 4.       | planId       | 是           | 协议模板id，由云闪付录入模板并分配给接入方   |

 

响应报文参数说明

| **序号** | **参数名**     | **是否必填** | **备注**                               |
| -------- | -------------- | ------------ | -------------------------------------- |
| 1.       | contractId     |              | 签约协议号                             |
| 2        | contractStatus |              | 签约状态：空-未签约 1-已签约  3-已解约 |

#### 5.4.5.4 报文示例



 

## 5.5 消息推送

### 5.5.1 消息推送（一个月）<new.msg.push>

#### 5.5.1.1 功能描述

消息推送接口。

#### 5.5.1.2 请求地址

https://open.95516.com/open/access/1.0/new.msg.push 

#### 5.5.1.3 报文结构

请求报文参数说明

| **序号** | **参数名**   | **是否必填** | **备注**                                              |
| -------- | ------------ | ------------ | ----------------------------------------------------- |
| 1        | appId        | 是           | 接入方的唯一标识                                      |
| 2        | backendToken | 是           | 基础服务令牌，通过”获取backendToken”接口获取          |
| 3        | openId       | 是           | 用户openId                                            |
| 4        | content      | 是           | 推送的内容（最大支持140个字符，若为中文，则大小为70） |
| 5        | url          | 是           | 接入方传递的url（必须是在提供的UPSDK安全域名内）      |

 

响应报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**                  |
| -------- | ---------- | ------------ | ------------------------- |
| 1        | appId      |              | 接入方的唯一标识          |
| 2        | openId     |              | 用户openId                |
| 3        | resultCd   |              | 应答码：00-成功，其他失败 |

#### 5.5.1.4 报文示例



 

## 5.6 实时退税

### 5.6.1 实时退税<return.tax>

#### 5.6.1.1 功能描述

接入方用户在云闪付APP海外实时退税操作接口。

#### 5.6.1.2 请求地址

[https://open.95516.com/open/access/1.0/return.tax ](https://open.95516.com/open/access/1.0/contract.status)

#### 5.6.1.3 报文结构

请求报文参数说明

| **序号** | **参数名**   | **是否必填** | **备注**                                     |
| -------- | ------------ | ------------ | -------------------------------------------- |
| 1        | appId        | 是           | 接入方的唯一标识                             |
| 2        | backendToken | 是           | 基础服务令牌，通过”获取backendToken”接口获取 |
| 3        | refundNo     | 是           | 退税号                                       |

 

响应报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**                                  |
| -------- | ---------- | ------------ | ----------------------------------------- |
| 1.       | cardNo     |              | 卡号（加密）                              |
| 2        | cardTyoe   |              | 卡类型 （1借记 2贷记 3准贷记 4 借贷合一） |
| 3        | resp       |              | 成功通知以后发送 {‘resp’: ‘00’} 返回      |

#### 5.6.1.4 报文示例



 

## 5.7 行业卡

### 5.7.1 行业卡操作<putIndustryCard >

#### 5.7.1.1 功能描述

接入方用户在云闪付APP编辑行业卡（增，删，改）操作。

#### 5.7.1.2 请求地址

https://open.95516.com/open/access/1.0/putIndustryCard 

#### 5.7.1.3 报文结构

请求报文参数说明

| **序号** | **参数名**   | **是否必填** | **备注**                                                     |
| -------- | ------------ | ------------ | ------------------------------------------------------------ |
| 1        | appId        | 是           | 接入方的唯一标识                                             |
| 2        | backendToken | 是           | 基础服务令牌，通过”获取backendToken”接口获取                 |
| 3        | cardModuleId | 是           | cardModuleId行业卡 卡片模板id（需向云闪付提交申请）          |
| 4        | bussCardNo   | 是           | 行业卡 卡号                                                  |
| 5        | cardSubTp    | 是           | 行业卡 卡片子类型，   用于表示卡等级或者商户/机构下的不同额度的卡片 |
| 6        | transTp      | 是           | 交易类型 01：添加； 02：更新； 03：删除                      |
| 7        | openId       | 是           | OAUTH2中获取的openId                                         |
| 8        | region       | 否           | 签发地区代码（云闪付地区代码）                               |
| 9        | channelNo    | 否           | 社保金融服务平台编号                                         |
| 10       | name         | 否           | 姓名（若上传，需加密）                                       |
| 11       | certId       | 否           | 身份证号（若上传，需加密）                                   |
| 12       | mobileNo     | 否           | 手机号码（若上传，需加密）                                   |

 

响应报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**                             |
| -------- | ---------- | ------------ | ------------------------------------ |
| 1        | resp       |              | 成功通知以后发送 {‘resp’: ‘00’} 返回 |

#### 5.7.1.4 报文示例



#### 说明：加密字段，请用云闪付分配给接入方的对称秘钥（symmetricKey）加密，加密内容为base64格式输出。加密方式：3DES，填充算法：DESede/ECB/PKCS5Padding。

## 5.8 红包相关

红包相关接入流程详见文末《附录十：红包/抽奖接入流程指引》。

### 5.8.1 红包赠送<red.packet.give>

#### 5.8.1.1 功能描述

接入方在云闪付进行红包赠送操作接口。

#### 5.8.1.2 请求地址

https://open.95516.com/open/access/1.0/red.packet.give

#### 5.8.1.3 报文结构

请求报文参数说明

| **序号** | **参数名**  | **是否必填** | **备注**                                                     |
| -------- | ----------- | ------------ | ------------------------------------------------------------ |
| 1        | appId       | 是           | 接入方的唯一标识                                             |
| 2        | insAcctId   | 是           | 机构账户代码 必须18位                                        |
| 3        | transNumber | 是           | 接入方交易流水号                                             |
| 4        | openId      | 否           | 用户标识                                                     |
| 5        | mobile      | 否           | 手机号使用symmetricKey 对称加密，内容为base64格式            |
| 6        | pan         | 否           | 同名卡号使用symmetricKey 对称加密，内容为base64格式          |
| 7        | pointAt     | 是           | 交易金额   单位：分，不能为负  （以分为单位，使用symmetricKey 对称加密，内容为base64格式） |
| 8        | remark      | 否           | 备注信息                                                     |
| 9        | nonceStr    | 是           | 生成签名的随机串                                             |
| 10       | timestamp   | 是           | 生成签名的时间戳                                             |
| 11       | signature   | 是           | 请使用接入方私钥签名，输出格式为base64.                      |

 

响应报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**                             |
| -------- | ---------- | ------------ | ------------------------------------ |
| 1        | resp       |              | 成功通知以后发送 {‘resp’: ‘00’} 返回 |

说明：

1.接入方使用私钥进行签名，云闪付使用接入方提供的的公钥进行验证签名。

2.openId、mobile、pan 3个参数不能同时为空，至少上送一个。

\3. mobile、pan、pointAt字段加密（使用云闪付提供symmetricKey 对称加密，内容为base64格式）上送，但参与签名时，请使用明文加签。

\4. 除了signature之外，请求参数中所有字段参与验签。所有待签名参数（字符编码为 UTF-8）按照字段名的ASCII 码从小到大排序（字典序）后，使用键值对的格式（即key1=value1&key2=value2…）拼接成字符串string1。

对拼接字符串string1进行RSA签名后，按base64格式出现在报文中。

#### 5.8.1.4 报文示例



 

### 5.8.2 红包 (机构账户)余额查询<red.packet.select>

#### 5.8.2.16.8.2.1功能描述

实时查询接入方红包(机构账户)余额数据接口。

#### 5.8.2.26.8.2.2请求地址

https://open.95516.com/open/access/1.0/red.packet.select

#### 5.8.2.36.8.2.3报文结构

请求报文参数说明

| **序号** | **参数名**   | **是否必填** | **备注**                                    |
| -------- | ------------ | ------------ | ------------------------------------------- |
| 1        | appId        | 是           | 接入方的唯一标识                            |
| 2        | insAcctId    | 是           | 机构账户代码 必须18位                       |
| 3        | transNumber  | 是           | 接入方交易流水号                            |
| 4        | transDt      | 是           | 请求日期 YYYYMMDD例：20190712               |
| 5        | transTm      | 是           | 请求时间 YYYYMMDDHHMMSS  例：20190712144820 |
| 6        | backendToken | 是           | 后台接口授权token                           |

 

响应报文参数说明

| **序号** | **参数名**     | **是否必填** | **备注**                                                  |
| -------- | -------------- | ------------ | --------------------------------------------------------- |
| 1        | acctSt         |              | 账户状态  （使用symmetricKey 对称加密，内容为base64格式） |
| 2        | acctBalance    |              | 账户余额  （使用symmetricKey 对称加密，内容为base64格式） |
| 3        | validBeginDtTm |              | 有效开始时间                                              |
| 4        | validEndDtTm   |              | 有效结束时间                                              |

#### 5.8.2.46.8.2.4报文示例



 

### 5.8.3 抽奖资格查询<qual.select>

#### 5.8.3.1 功能描述

接入方在云闪付查询用户抽奖资格接口。

#### 5.8.3.2 请求地址

https://open.95516.com/open/access/1.0/qual.select

#### 5.8.3.3 报文结构

请求报文参数说明

| **序号** | **参数名**   | **是否必填** | **备注**                                                |
| -------- | ------------ | ------------ | ------------------------------------------------------- |
| 1        | appId        | 是           | 接入方的唯一标识                                        |
| 2        | qualNum      | 是           | 资格池编号                                              |
| 3        | qualType     | 是           | 资格类型  固定值“open_id”、“mobile”、“card_no”          |
| 4        | qualValue    | 是           | 资格值  （使用symmetricKey 对称加密，内容为base64格式） |
| 5        | backendToken | 是           | 后台接口授权token                                       |

 

响应报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**                                                     |
| -------- | ---------- | ------------ | ------------------------------------------------------------ |
| 1        | qualMap    |              | 满足要求的资格为map结构，key是资格有效期拼接格式如20171108_20171101（结束日期在前），value为资格次数 |

#### 5.8.3.4 报文示例



 

### 5.8.4 抽奖资格赠送<qual.send>

#### 5.8.4.1 功能描述

接入方给用户赠送抽奖资格接口。

#### 5.8.4.2 请求地址

https://open.95516.com/open/access/1.0/qual.send

#### 5.8.4.3 报文结构

请求报文参数说明

| **序号** | **参数名**  | **是否必填** | **备注**                                                     |
| -------- | ----------- | ------------ | ------------------------------------------------------------ |
| 1        | appId       | 是           | 接入方的唯一标识                                             |
| 2        | qualNum     | 是           | 资格池编号                                                   |
| 3        | qualType    | 是           | 资格类型  固定值“open_id”、“mobile”、“card_no”               |
| 4        | qualValue   | 是           | 资格值  （使用symmetricKey 对称加密，内容为base64格式）      |
| 5        | count       | 是           | 资格增加次数  （使用symmetricKey 对称加密，内容为base64格式） |
| 6        | transNumber | 是           | 流水号（确保唯一）                                           |
| 7        | startDate   | 是           | 资格起始时间 格式为yyyyMMdd                                  |
| 8        | endDate     | 是           | 资格结束时间 格式为yyyyMMdd                                  |
| 9        | nonceStr    | 是           | 生成签名的随机串                                             |
| 10       | timestamp   | 是           | 生成签名的时间戳                                             |
| 11       | signature   | 是           | 请使用接入方私钥签名，输出格式为base64.                      |

 

响应报文参数说明

| **序号** | **参数名** | **是否必填** | **备注**                             |
| -------- | ---------- | ------------ | ------------------------------------ |
| 1        | resp       |              | 成功通知以后发送 {‘resp’: ‘00’} 返回 |

#### 5.8.4.4 报文示例



 

### 5.8.5 抽奖（红包/票券）<qual.reduce>

#### 5.8.5.1 功能描述

接入方通过云闪付抽奖（红包/票券）接口，给用户赠送（非定额/定额）红包或者商城券。

#### 5.8.5.2 请求地址

https://open.95516.com/open/access/1.0/qual.reduce

#### 5.8.5.3 报文结构

请求报文参数说明

| **序号** | **参数名**     | **是否必填** | **备注**                                                  |
| -------- | -------------- | ------------ | --------------------------------------------------------- |
| 1        | appId          | 是           | 接入方的唯一标识                                          |
| 2        | activityNumber | 是           | 活动 编号                                                 |
| 3        | orderAmount    | 否           | 订单金额                                                  |
| 4        | qualNum        | 是           | 资格池编号                                                |
| 5        | qualType       | 是           | 资格类型  固定值“open_id”、“mobile”、“card_no”            |
| 6        | qualValue      | 是           | 资格值  （使用symmetricKey 对称加密，内容为base64格式）   |
| 7        | certId         | 否           | 身份证号  （使用symmetricKey 对称加密，内容为base64格式） |
| 8        | icTerminal     | 否           | 设备终端                                                  |
| 9        | qrCode         | 否           | 红包码                                                    |
| 10       | transNumber    | 是           | 流水号（确保唯一）                                        |
| 11       | nonceStr       | 是           | 生成签名的随机串                                          |
| 12       | timestamp      | 是           | 生成签名的时间戳                                          |
| 13       | signature      | 是           | 请使用接入方私钥签名，输出格式为base64.                   |

 

响应报文参数说明

| **序号** | **参数名**  | **是否必填** | **备注**                             |
| -------- | ----------- | ------------ | ------------------------------------ |
| 1        | resp        |              | 成功通知以后发送 {‘resp’: ‘00’} 返回 |
| 2        | respTime    |              | 结果时间 yyyyMMddHHmmss              |
| 3        | awardInfo   |              | 奖项信息   内容字段如下6.6.5.4表格   |
| 4        | transNumber |              | 订单流水号                           |

 awardInfo信息

| **数据名称**    | **中文名称**             | **选填/****必填** | **说明**                              |
| --------------- | ------------------------ | ----------------- | ------------------------------------- |
| activityNumber  | 活动编号                 | 选填              |                                       |
| activityName    | 活动名称                 | 选填              |                                       |
| beginTime       | 活动开始时间             | 选填              |                                       |
| endTime         | 活动结束时间             | 选填              |                                       |
| awardId         | 奖项Id                   | 选填              |                                       |
| awardType       | 奖项类型                 | 选填              | 06：红包  07：商城券                  |
| awardName       | 奖项名称                 | 选填              |                                       |
| awardValue      | 奖项值                   | 选填              | 红包为红包金额，单位:分  商城券为张数 |
| extAcctId       | 外部账户id               | 选填              | 商城券为券ID                          |
| extAcctName     | 外部账户名称             | 选填              | 商城券为券名称                        |
| drawDesc        | 中奖说明                 | 选填              |                                       |
| couponStartDate | 商城券生效开始时间       | 选填              |                                       |
| couponEndDate   | 商城券生效结束时间       | 选填              |                                       |
| couponGoodsUrl  | 商城券对应商品的链接地址 | 选填              |                                       |

说明：                                        

除了signature之外，请求参数中所有字段参与验签。所有待签名参数（字符编码为 UTF-8）按照字段名的ASCII 码从小到大排序（字典序）后，使用键值对的格式（即key1=value1&key2=value2…）拼接成字符串string1。对拼接字符串string1进行RSA签名后，按base64格式出现在报文中。

 

#### 5.8.5.4 报文示例

